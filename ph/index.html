<!doctype html>
<html lang="ja">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-VSEFPGK0YZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-VSEFPGK0YZ');
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Noa | links</title>
  <meta name="description" content="Noa links" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@500;700;800;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Hachi+Maru+Pop&display=swap" rel="stylesheet">

  <style>
    :root{
      --bgBase:#fff0ebff;
      --bgSize:cover; --bgRepeat:no-repeat; --bgPos:center; --bgTransition:1s;
      --veilOpacity:.30; --veilOpacityPortrait:.42;

      --fontFamily:"M PLUS Rounded 1c", system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
      --titleFont:"Hachi Maru Pop", cursive;

      --containerMax:760px;
      --padTop:30px; --padSide:16px; --padBottom:40px;

      --titleSize:38px; --subtitleSize:18px;
      --titleColor:#fff; --subtitleColor:rgba(255,255,255,.9);
      --textShadow:0 6px 20px rgba(0,0,0,.35);

      --snsSize:88px; --snsIconSize:40px; --snsGap:10px; --snsRadius:14px;

      --cardMax:760px;
      --cardBg:rgba(255,255,255,.25);
      --cardBorder:rgba(255,255,255,.28);
      --cardRadius:22px;
      --cardShadow:0 18px 50px rgba(0,0,0,.20), inset 0 1px 0 rgba(255,255,255,.35);

      --sectionPad:18px;
      --brand:#A67189;

      --footerColor:rgba(255,255,255,.78);
      --footerSize:12px;

      /* language switch */
      --langGap:10px;
      --langMt:14px;
      --langBtnH:34px;
      --langBtnPx:14px;
      --langBtnRadius:12px;
      --langBtnBg:rgba(255,255,255,.25);
      --langBtnBorder:rgba(255,255,255,.28);
      --langBtnText:rgba(255,255,255,.92);
      --langBtnBgActive:rgba(255,255,255,.40);
      --langBtnTextActive:rgba(255,255,255,1);
    }

    @media (max-width:420px){
      :root{
        --padTop:22px;
        --titleSize:30px; --subtitleSize:16px;
        --snsSize:72px; --snsIconSize:34px;
        --langBtnH:32px;
        --langBtnPx:12px;
        --sectionPad:16px;
      }
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--fontFamily);
      color:var(--titleColor);

      background-color:var(--bgBase);
      background-image:none;
      background-size:var(--bgSize);
      background-repeat:var(--bgRepeat);
      background-position:var(--bgPos);
      background-attachment:fixed;
      transition:background-image var(--bgTransition) ease-in-out;
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      background:rgba(255,240,235,var(--veilOpacity));
      z-index:-1;
    }

    .wrap{
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:var(--padTop) var(--padSide) var(--padBottom);
      text-align:center;
    }

    /* âœ… å³ç«¯ãã£ã¤ãå•é¡Œã®æœ¬ä¸¸ï¼šcontainerã‚’å¸¸ã«ä¸­å¤® + å·¦å³ä½™ç™½å›ºå®š */
    .container{
      width:100%;
      max-width:760px;
      margin:0 auto;
      padding-left: max(16px, env(safe-area-inset-left));
      padding-right: max(16px, env(safe-area-inset-right));
      box-sizing:border-box;
    }

    .title{
      margin:0 0 6px;
      font-family:var(--titleFont);
      font-size:var(--titleSize);
      font-weight:900;
      text-shadow:var(--textShadow);
    }
    .subtitle{
      margin:0 0 10px;
      font-size:var(--subtitleSize);
      font-weight:800;
      color:var(--subtitleColor);
      text-shadow:var(--textShadow);
    }

    /* ===== section ===== */
    .section{
      width:100%;
      margin:0 0 16px;
      background:var(--cardBg);
      border:1px solid var(--cardBorder);
      border-radius:var(--cardRadius);
      box-shadow:var(--cardShadow);
      backdrop-filter:blur(14px);
      -webkit-backdrop-filter:blur(14px);
      padding:var(--sectionPad);
      text-align:left;
      box-sizing:border-box;
    }

    .section h2{
      margin:0 0 12px;
      font-size:18px;
      font-weight:900;
      text-shadow:var(--textShadow);
      text-align:left;
    }

    /* ===== gridï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯3åˆ—ï¼ˆPC/æ¨ªå‘ãï¼‰ ===== */
    .grid{
      display:grid;
      gap:14px;
      grid-template-columns: repeat(3, 1fr);
      align-items:stretch;
    }

    /* âœ… ç¸¦æŒã¡ã¯å¿…ãš2åˆ—ï¼ˆæ©Ÿç¨®ä¾å­˜æ’é™¤ï¼‰ */
    @media (orientation: portrait){
      .grid{ grid-template-columns: repeat(2, 1fr); }
    }

    /* ã•ã‚‰ã«ç‹­ã„ç«¯æœ«ã ã‘ã¯1åˆ—ï¼ˆä»»æ„ï¼‰ */
    @media (max-width: 360px){
      .grid{ grid-template-columns: 1fr; }
    }

    .vcard{
      background:rgba(255,255,255,.20);
      border:1px solid rgba(255,255,255,.22);
      border-radius:18px;
      overflow:hidden;
      color:#fff;

      display:flex;
      flex-direction:column;
      height:100%;
      min-width:0;
    }

    .thumb-wrap{
      width:100%;
      border-radius:16px;
      overflow:hidden;
      background:rgba(255,255,255,.18);
    }
    .thumb{
      width:100%;
      height:auto;
      display:block;
      object-fit:contain;
      background:transparent;
    }

    .vmeta{
      padding:10px;
      display:flex;
      flex-direction:column;
      flex:1;
      min-width:0;
    }

    .vtitle{
      font-weight:900;
      font-size:14px;
      line-height:1.35;
      margin:0 0 10px;
      text-shadow:var(--textShadow);

      display:-webkit-box;
      -webkit-box-orient:vertical;
      -webkit-line-clamp:2;
      overflow:hidden;
      min-height: calc(14px * 1.35 * 2);
    }

    .btn{
      display:block;
      text-align:center;
      padding:10px;
      border-radius:14px;
      font-weight:900;
      text-decoration:none;
      margin-bottom:8px;
      border:1px solid rgba(255,255,255,.18);
      box-sizing:border-box;

      /* âœ… ãƒœã‚¿ãƒ³æ–‡å­—ãŒ2è¡Œã«ãªã‚‹ã®ã‚’æŠ‘æ­¢ */
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      font-size:14px;
    }

    .btn-main{
      background:var(--brand);
      color:#fff;
    }
    .btn-sub{
      background:rgba(166,113,137,.20);
      color:#fff;
    }

    /* âœ… ç¸¦æŒã¡ã ã‘ã€ãƒœã‚¿ãƒ³/ã‚¿ã‚¤ãƒˆãƒ«ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’å°‘ã—è½ã¨ã—ã¦1è¡Œã«å¯„ã›ã‚‹ */
    @media (orientation: portrait){
      .vtitle{ font-size:13px; min-height: calc(13px * 1.35 * 2); }
      .btn{ font-size:13px; padding:9px; }
    }

    /* ===== æœˆé¡FCãƒœã‚¿ãƒ³ï¼ˆ4å€‹ä¸¦ã³ï¼‰ ===== */
    .fc-btns{
      display:grid;
      gap:10px;
      margin-top:8px;
      grid-template-columns: repeat(4, 1fr);
      align-items:stretch;
    }

    /* ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ */
    @media (max-width:900px){
      .fc-btns{ grid-template-columns: repeat(2, 1fr); }
    }

    /* ã‚¹ãƒãƒ› */
    @media (max-width:480px){
      .fc-btns{ grid-template-columns: 1fr; }
    }

    .fc-btn{
      margin:0 !important;
      padding:10px 0;
      border-radius:12px;
      min-width:0;
    }

    .fc-btn.btn-sub{
      border-color: rgba(255,255,255,.10);
    }

    /* ===== SNSï¼ˆã‚«ãƒ¼ãƒ‰å¤–ï¼šæœˆé¡ã®ç›´ä¸‹ï¼‰ ===== */
    .social{
      display:flex;
      justify-content:center;
      align-items:center;
      gap:var(--snsGap);
      margin:0 0 16px;
    }
    .social a{
      width:var(--snsSize);
      height:var(--snsSize);
      display:grid;
      place-items:center;
      border-radius:var(--snsRadius);
      text-decoration:none;
      background:transparent;
    }
    .social img{
      width:var(--snsIconSize);
      height:var(--snsIconSize);
      display:block;
      filter:brightness(0) invert(1);
    }

    .lang{
      margin-top: var(--langMt);
      display:flex;
      justify-content:center;
      gap: var(--langGap);
    }
    .lang button{
      height: var(--langBtnH);
      padding: 0 var(--langBtnPx);
      border-radius: var(--langBtnRadius);
      background: var(--langBtnBg);
      border: 1px solid var(--langBtnBorder);
      color: var(--langBtnText);
      font-weight: 900;
      font-family: var(--fontFamily);
      cursor:pointer;
      text-shadow: var(--textShadow);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      transition: filter .18s ease, transform .08s ease, background .18s ease, color .18s ease;
    }
    .lang button:hover{ filter: brightness(1.08); }
    .lang button:active{ transform: scale(.98); }
    .lang button.is-active{
      background: var(--langBtnBgActive);
      color: var(--langBtnTextActive);
    }

    .foot{
      margin-top:14px;
      font-size:var(--footerSize);
      color:var(--footerColor);
      text-shadow:var(--textShadow);
      text-align:center;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="container">
      <h1 class="title" id="tTitle">ã®ã‚à­¨à­§</h1>
      <p class="subtitle" id="tSub">ç”°èˆã§æš®ã‚‰ã™é™°ã‚­ãƒ£å¥³å­</p>

      <!-- ğŸ”¥ ä»Šã™ãè¦‹ã‚‹ï¼ˆmyfans_latest order 1..3ï¼‰ -->
      <div class="section" aria-label="Watch now">
        <h2 id="secNow">ğŸ”¥ ä»Šã™ãè¦‹ã‚‹</h2>
        <div class="grid" id="videoGrid"></div>
      </div>

      <!-- â­ äººæ°—3æœ¬ï¼ˆother_bn order 1..3ï¼‰ -->
      <div class="section" aria-label="Popular 3">
        <h2 id="secPop">â­ äººæ°—3æœ¬</h2>
        <div class="grid" id="popularGrid"></div>
      </div>

      <!-- ğŸ’ æœˆé¡ã§å…¨éƒ¨è¦‹ã‚‹ -->
      <div class="section" aria-label="Subscribe monthly">
        <h2 id="secSub">ğŸ’ æœˆé¡ã§å…¨éƒ¨è¦‹ã‚‹</h2>

        <div class="fc-btns" aria-label="Fanclub links">
          <a class="btn btn-main fc-btn" href="https://candfans.jp/noanoshita?plan-contents=17822" target="_blank" rel="noopener">CandFans</a>
          <a class="btn btn-sub  fc-btn" href="https://myfans.jp/account/plans/118dc278-f5db-49bb-ab25-f66723160f18?tab=posts" target="_blank" rel="noopener">MyFans</a>
          <a class="btn btn-sub  fc-btn" href="https://fantia.jp/fanclubs/532786" target="_blank" rel="noopener">Fantia</a>
          <a class="btn btn-sub  fc-btn" href="https://onlyfans.com/noanoshita" target="_blank" rel="noopener">OnlyFans</a>
        </div>
      </div>

      <!-- SNSï¼šæœˆé¡ã®ç›´ä¸‹ï¼ˆã‚«ãƒ¼ãƒ‰å¤–ï¼‰ -->
      <div class="social" aria-label="SNS links">
        <a href="https://x.com/noanoshita" target="_blank" rel="noopener" aria-label="X">
          <img src="../images/X.png" alt="X">
        </a>
        <a href="https://www.instagram.com/noanoshita/" target="_blank" rel="noopener" aria-label="Instagram">
          <img src="../images/instagram.png" alt="Instagram">
        </a>
        <a href="https://www.youtube.com/@challengenoa" target="_blank" rel="noopener" aria-label="YouTube">
          <img src="../images/Youtube.png" alt="YouTube">
        </a>
      </div>

      <div class="lang" aria-label="Language switch">
        <button id="btnJP" type="button" onclick="setLang('ja')">JP</button>
        <button id="btnEN" type="button" onclick="setLang('en')">EN</button>
      </div>

      <div class="foot">Â© Noa</div>
    </div>
  </div>

  <script>
    // ===== èƒŒæ™¯ç”»åƒï¼ˆlinksé…ä¸‹ãªã®ã§ ../images/ï¼‰ =====
    const BG = {
      morning: "../images/morning.png",
      evening: "../images/evening.jpg",
      night: "../images/night.jpg"
    };

    function pickBgByTime(){
      const h = new Date().getHours();
      if(h >= 5 && h < 16) return BG.morning;
      if(h >= 16 && h < 19) return BG.evening;
      return BG.night;
    }

    function applyBgModeByAspect(imgUrl){
      const img = new Image();
      img.onload = () => {
        const portrait = img.naturalHeight > img.naturalWidth;
        document.documentElement.style.setProperty('--bgSize', portrait ? 'contain' : 'cover');
        document.documentElement.style.setProperty('--veilOpacity', portrait ? getComputedStyle(document.documentElement).getPropertyValue('--veilOpacityPortrait').trim() : '.30');
        document.body.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--bgBase').trim();
      };
      img.onerror = () => {
        document.documentElement.style.setProperty('--bgSize', 'cover');
        document.documentElement.style.setProperty('--veilOpacity', '.30');
        document.body.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--bgBase').trim();
      };
      img.src = imgUrl;
    }

    function setBG(){
      const imgUrl = pickBgByTime();
      document.body.style.backgroundImage = `url('${imgUrl}')`;
      applyBgModeByAspect(imgUrl);
    }
    setBG();

    // ===== GAS JSONï¼ˆæ–°URLï¼‰ =====
    const API_URL = "https://script.google.com/macros/s/AKfycbxT_J40PjHDRD-sGVGrM3zPA8Loj7XV9yDV988lkMB7rXVQ7Epka8ZK8aOdYI5NriY1/exec";

    function escHtml(s){
      return String(s ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function getLang(){
      try{
        const saved = localStorage.getItem("lang") || "ja";
        return (saved === "en") ? "en" : "ja";
      }catch(e){
        return "ja";
      }
    }

    async function loadVideos(){
      const nowGrid = document.getElementById("videoGrid");
      const popGrid = document.getElementById("popularGrid");
      const lang = getLang();

      const renderCard = (v) => {
        const title = (lang === "en" && v.translation) ? v.translation : v.title;

        return `
          <div class="vcard">
            <div class="thumb-wrap">
              <img class="thumb" src="${escHtml(v.thumb_url)}" alt="">
            </div>
            <div class="vmeta">
              <div class="vtitle">${escHtml(title)}</div>
              ${v.url_CF ? `<a class="btn btn-main" href="${escHtml(v.url_CF)}" target="_blank" rel="noopener">CandFansã§è¦‹ã‚‹</a>` : ``}
              ${v.url_MY ? `<a class="btn btn-sub"  href="${escHtml(v.url_MY)}" target="_blank" rel="noopener">MyFansã§è¦‹ã‚‹</a>`   : ``}
            </div>
          </div>
        `;
      };

      try{
        const res = await fetch(API_URL + "?t=" + Date.now(), { cache: "no-store" });
        const data = await res.json();

        const nowList = (data.myfans_latest || [])
          .sort((a,b)=>Number(a.order)-Number(b.order))
          .slice(0,3);

        const popList = (data.other_bn || [])
          .sort((a,b)=>Number(a.order)-Number(b.order))
          .slice(0,3);

        nowGrid.innerHTML = nowList.length
          ? nowList.map(renderCard).join("")
          : `<div style="opacity:.9;font-weight:800;text-shadow:var(--textShadow);">æº–å‚™ä¸­</div>`;

        if(popGrid){
          popGrid.innerHTML = popList.length
            ? popList.map(renderCard).join("")
            : `<div style="opacity:.9;font-weight:800;text-shadow:var(--textShadow);">æº–å‚™ä¸­</div>`;
        }

      }catch(e){
        nowGrid.innerHTML = `<div style="opacity:.9;font-weight:800;text-shadow:var(--textShadow);">èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>`;
        if(popGrid) popGrid.innerHTML = "";
      }
    }

    // åˆå›æç”»
    loadVideos();

    // ===== è¨€èªï¼ˆå…¨ãƒšãƒ¼ã‚¸é€£å‹•ï¼‰ =====
    const I18N = {
      ja: {
        htmlLang:"ja",
        title:"ã®ã‚à­¨à­§",
        sub:"ç”°èˆã§æš®ã‚‰ã™é™°ã‚­ãƒ£å¥³å­",
        secNow:"ğŸ”¥ ä»Šã™ãè¦‹ã‚‹",
        secPop:"â­ äººæ°—3æœ¬",
        secSub:"ğŸ’ æœˆé¡ã§å…¨éƒ¨è¦‹ã‚‹"
      },
      en: {
        htmlLang:"en",
        title:"Noa",
        sub:"Quiet countryside girl",
        secNow:"ğŸ”¥ Watch now",
        secPop:"â­ Popular 3",
        secSub:"ğŸ’ Subscribe monthly"
      }
    };

    function setLang(lang){
      const t = I18N[lang] || I18N.ja;
      document.documentElement.lang = t.htmlLang;

      document.getElementById("tTitle").textContent = t.title;
      document.getElementById("tSub").textContent = t.sub;
      document.getElementById("secNow").textContent = t.secNow;
      document.getElementById("secPop").textContent = t.secPop;
      document.getElementById("secSub").textContent = t.secSub;

      document.getElementById("btnJP").classList.toggle("is-active", lang === "ja");
      document.getElementById("btnEN").classList.toggle("is-active", lang === "en");

      try { localStorage.setItem("lang", lang); } catch(e) {}

      // âœ… é‡è¦ï¼šè¨€èªåˆ‡æ›¿ã§ã‚«ãƒ¼ãƒ‰ã‚‚ç¿»è¨³ã«åˆã‚ã›ã¦å†æç”»
      loadVideos();
    }

    (function initLang(){
      let saved = "ja";
      try { saved = localStorage.getItem("lang") || "ja"; } catch(e) {}
      setLang(saved === "en" ? "en" : "ja");
    })();
  </script>
</body>
</html>

